"use strict";(self["webpackChunkweek7"]=self["webpackChunkweek7"]||[]).push([[331],{1530:function(t,e,a){function s(t){return{all:t=t||new Map,on:function(e,a){var s=t.get(e);s?s.push(a):t.set(e,[a])},off:function(e,a){var s=t.get(e);s&&(a?s.splice(s.indexOf(a)>>>0,1):t.set(e,[]))},emit:function(e,a){var s=t.get(e);s&&s.slice().map((function(t){t(a)})),(s=t.get("*"))&&s.slice().map((function(t){t(e,a)}))}}}a.d(e,{Z:function(){return i}});const o=s();var i=o},7331:function(t,e,a){a.r(e),a.d(e,{default:function(){return P}});var s=a(6252),o=a(3577),i=a(9963);const c=t=>((0,s.dD)("data-v-7130bc89"),t=t(),(0,s.Cn)(),t),r={class:"container py-5"},n=c((()=>(0,s._)("h2",{class:"text-center mb-3"},"購物車內容",-1))),d={class:"table align-middle"},l=c((()=>(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{class:"text-center"},"刪除"),(0,s._)("th",{class:"text-center",style:{width:"150px"}},"圖片"),(0,s._)("th",{class:"text-center"},"品名"),(0,s._)("th",{class:"text-start",style:{width:"150px"}},"數量/單位"),(0,s._)("th",{class:"text-center"},"單價")])],-1))),u={class:"text-center"},h=["onClick"],p=c((()=>(0,s._)("i",{class:"bi bi-trash-fill"},null,-1))),g=[p],m={class:"text-center"},v={class:"text-center"},_={class:"text-start"},b={class:"input-group input-group-sm"},f={class:"input-group mb-3"},x=["onUpdate:modelValue","onChange","disabled"],C=["value"],w={class:"input-group-text",id:"basic-addon2"},y={class:"text-center"},k=c((()=>(0,s._)("td",{colspan:"4",class:"text-end"},"總計",-1))),I={class:"text-center"},$={class:"order-column d-flex justify-content-evenly"},D=["disabled"],L=(0,s.Uk)("確定訂單");function M(t,e,a,c,p,M){const q=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",r,[n,(0,s._)("div",null,[(0,s._)("table",d,[l,(0,s._)("tbody",null,[p.cartData.carts?((0,s.wg)(!0),(0,s.iD)(s.HY,{key:0},(0,s.Ko)(p.cartData.carts,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("td",u,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm text-center",onClick:e=>M.removeCartItem(t.id)},g,8,h)]),(0,s._)("td",m,[(0,s._)("div",{style:(0,o.j5)([{backgroundImage:`url(${t.product.imageUrl})`},{height:"100px",width:"100px","background-size":"cover","background-position":"center"}])},null,4)]),(0,s._)("td",v,(0,o.zw)(t.product.title),1),(0,s._)("td",_,[(0,s._)("div",b,[(0,s._)("div",f,[(0,s.wy)((0,s._)("select",{id:"",class:"form-select","onUpdate:modelValue":e=>t.qty=e,onChange:e=>M.updateCart(t),disabled:p.isLoadingItem===t.id},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(300,(e=>(0,s._)("option",{value:e,key:`${e}-${t.id}`},(0,o.zw)(e),9,C))),64))],40,x),[[i.bM,t.qty]]),(0,s._)("span",w,(0,o.zw)(t.product.unit),1)])])]),(0,s._)("td",y,(0,o.zw)(t.total),1)])))),128)):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[k,(0,s._)("td",I,(0,o.zw)(p.cartData.total),1)])])])]),(0,s._)("div",$,[(0,s._)("button",{class:"btn btn-outline-warning btn-sm fs-5 px-3 py-2",type:"button",onClick:e[0]||(e[0]=(...t)=>M.removeCartItems&&M.removeCartItems(...t)),disabled:0===p.cartData.carts.length}," 清空購物車 ",8,D),(0,s.Wm)(q,{to:"/confirm",class:"btn btn-outline-danger btn-sm fs-5 px-3 py-2"},{default:(0,s.w5)((()=>[L])),_:1})])])}var q=a(1530),z={data(){return{cartData:{carts:[]},form:{user:{name:"",email:"",tel:"",address:"",message:""}},products:[],product:{},productId:"",isLoadingItem:""}},methods:{getProducts(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ttest/products/all").then((t=>{this.products=t.data.products}))},openProductModal(t){this.productId=t,this.$refs.productModal.openModal()},getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ttest/cart").then((t=>{this.cartData=t.data.data}))},addToCart(t,e=1){const a={product_id:t,qty:e};this.isLoadingItem=t,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ttest/cart",{data:a}).then((t=>{console.log(t.data),this.getCart(),this.$refs.productModal.closeModal(),this.isLoadingItem="",q.Z.emit("get-cart")})).catch((t=>{console.log(t.data)}))},removeCartItem(t){this.isLoadingItem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ttest/cart/${t}`).then((t=>{this.getCart(),this.isLoadingItem="",q.Z.emit("get-cart")}))},removeCartItems(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/ttest/carts").then((()=>{this.getCart(),q.Z.emit("get-cart")})).catch((t=>{console.log(t.data)}))},updateCart(t){const e={product_id:t.product.id,qty:t.qty};this.isLoadingItem=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ttest/cart/${t.id}`,{data:e}).then((t=>{console.log(t.data),this.getCart(),this.isLoadingItem="",q.Z.emit("get-cart")}))},createOrder(){const t="https://vue3-course-api.hexschool.io/v2/api/ttest/order",e=this.form;this.$http.post(t,{data:e}).then((t=>{console.log(t),alert(t.data.message),this.$refs.form.resetForm(),this.form.message="",this.getCart()})).catch((t=>{alert(t.data.message)}))}},mounted(){this.getProducts(),this.getCart()}},Z=a(3744);const U=(0,Z.Z)(z,[["render",M],["__scopeId","data-v-7130bc89"]]);var P=U}}]);
//# sourceMappingURL=331.51e10b0b.js.map